/*! Fabrik */
var FbRepeatGroup=new Class({Implements:[Options,Events],options:{repeatmin:1},initialize:function(e,t){this.element=document.id(e),this.setOptions(t),this.counter=this.getCounter(),this.watchAdd(),this.watchDelete()},repeatContainers:function(){return this.element.getElements(".repeatGroup")},watchAdd:function(){this.element.getElement("a[data-button=addButton]").addEvent("click",function(e){e.stop();var e=this.repeatContainers().getLast(),t=(newc=this.counter+1,e.id.replace("-"+this.counter,"-"+newc)),t=new Element("div",{class:"repeatGroup",id:t}).set("html",e.innerHTML);t.inject(e,"after"),this.counter=newc,0!==this.counter&&(t.getElements("input, select").each(function(s){var e,a="",o=s.id;""!==s.id&&((e=s.id.split("-")).pop(),a=e.join("-")+"-"+this.counter,s.id=a),this.increaseName(s),$H(FabrikAdmin.model.fields).each(function(e,t){var n=!1;if("null"!==typeOf(FabrikAdmin.model.fields[t][o])){var i=FabrikAdmin.model.fields[t][o],n=Object.clone(i);try{n.cloned(a,this.counter)}catch(e){fconsole("no clone method available for "+s.id)}}!1!==n&&(FabrikAdmin.model.fields[t][s.id]=n)}.bind(this))}.bind(this)),t.getElements("img[src=components/com_fabrik/images/ajax-loader.gif]").each(function(e){var t=e.id.split("-"),t=(t.pop(),t.join("-")+"-"+this.counter+"_loader");e.id=t}.bind(this)))}.bind(this))},getCounter:function(){return this.repeatContainers().length},watchDelete:function(){this.element.getElements("a[data-button=deleteButton]").removeEvents(),this.element.getElements("a[data-button=deleteButton]").each(function(e,t){e.addEvent("click",function(e){e.stop(),this.getCounter()>this.options.repeatmin&&this.repeatContainers().getLast().destroy(),this.rename(t)}.bind(this))}.bind(this))},increaseName:function(e){var t=e.name.split("]["),n=t[2].replace("]","").toInt()+1;t.splice(2,1,n),e.name=t.join("][")+"]"},rename:function(t){this.element.getElements("input, select").each(function(e){e.name=this._decreaseName(e.name,t)}.bind(this))},_decreaseName:function(e,t){var e=e.split("]["),n=e[2].replace("]","").toInt();return 1<=n&&t<n&&n--,3===e.length&&(n+="]"),e.splice(2,1,n),e.join("][")}});
//# sourceMappingURL=repeatgroup-min.js.map