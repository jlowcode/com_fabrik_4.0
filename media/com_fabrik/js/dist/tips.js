/*! Fabrik */
var FloatingTips=new Class({Implements:[Options,Events],options:{fxProperties:{transition:Fx.Transitions.linear,duration:500},position:"top",showOn:"mouseenter",hideOn:"mouseleave",content:"title",distance:50,tipfx:"Fx.Transitions.linear",duration:500,fadein:!1,showFn:function(t){return t.stop(),!0},hideFn:function(t){return t.stop(),!0}},initialize:function(elements,options){this.setOptions(options),this.options.fxProperties={transition:eval(this.options.tipfx),duration:this.options.duration},window.addEvent("tips.hideall",function(t,e){"element"===typeOf(t)&&(e=t),this.hideOthers(e)}.bind(this)),elements&&this.attach(elements)},attach:function(t){this.elements=$$(t),this.elements.each(function(t){var e,i,n={},o=(t.get("opts","{}").opts&&JSON.validate(t.get("opts","{}").opts)&&(n=JSON.parse(t.get("opts","{}").opts)),Object.merge(Object.clone(this.options),n)),n=t.retrieve("opts",{});t.erase("opts"),n[o.showOn]||(n[o.showOn]=o,t.store("opts",n),n=this.getTipContent(t,o.showOn),i=new Element("div.floating-tip.tip"+o.position),e=new Element("div.floating-tip-wrapper"),"string"===typeOf(n)?(n=Encoder.htmlDecode(n),i.set("html",n)):i.adopt(n),e.adopt(i),e.inject(document.body).hide(),e.addEvent("mouseleave",function(t){"mouseleave"===o.hideOn&&e.hide()}.bind(this)),(n=t.retrieve("tip",{}))[o.showOn]=e,t.store("tip",n),i=Object.merge({onComplete:function(t){this.hideMe&&this.tip.hide()},onStart:function(t){this.hideMe=!1}},Object.clone(this.options.fxProperties)),(n=new Fx.Morph(e,i)).tip=e,(i=t.retrieve("fx",{}))[o.showOn]=n,t.store("fxs",i),this.addStartEvent(t,o.showOn),this.addEndEvent(t,o.showOn))}.bind(this))},addStartEvent:function(i,n){var o=(o=i.retrieve("opts"))[n];i.addEvent(o.showOn,function(t){if("click"===o.showOn){var e=i.retrieve("active",!1);if(i.store("active",!e),e)return}o.showFn(t,i)&&(window.fireEvent("tips.hideall",[i]),this.show(i,n))}.bind(this))},addEndEvent:function(e,i){var n=(n=e.retrieve("opts"))[i];e.addEvent(n.hideOn,function(t){e.retrieve("tip")[n.showOn];n.hideFn(t)&&this.hide(e,i)}.bind(this))},getTipContent:function(t,e){var i,n=t.retrieve("opts")[e].content;switch(typeOf(n)){case"string":i=t.get(n),t.set(n,"");break;case"element":i=n;break;default:i=n(t)}return i},show:function(t,e){var i=t.retrieve("tip"),n=t.retrieve("opts"),o=i[(n=n[e]).showOn];if(1!==o.getStyle("opacity")||"none"===o.getStyle("display")||"null"===typeOf(o.getParent())){o.setStyle("opacity",0),o.show(),"null"===typeOf(n.position)&&(n.position="left");var s=n.distance;switch(n.position){case"top":var r=o.getStyle("border-top").toInt()+o.getStyle("border-bottom").toInt(),a={x:0,y:-1*s-2*r};edge="top";break;case"bottom":edge="top",a={x:0,y:s+(r=o.getStyle("border-top").toInt()+o.getStyle("border-bottom").toInt())};break;case"right":a={x:s+(r=o.getStyle("border-left").toInt()+o.getStyle("border-right").toInt()),y:0},edge="left";break;default:a={x:-1*s-(r=o.getStyle("border-left").toInt()+o.getStyle("border-right").toInt()),y:0},edge="right"}var i={relativeTo:t,position:n.position,edge:edge,offset:a},h=(o.position(i),this.options.fadein||o.setStyle("opacity",1),this.options.fadein?{opacity:[0,1]}:{});o.getCoordinates(),t.getCoordinates();switch(n.position){case"top":var p=o.getStyle("top").toInt()-o.getStyle("height").toInt();h.top=[p,p+s];break;case"bottom":p=o.getStyle("top").toInt(),h.top=[p,p-s];break;case"right":l=o.getStyle("left").toInt(),h.left=[l,l-s];break;case"left":l=o.getStyle("left").toInt(),h.left=[l,l+s]}e=t.retrieve("fxs")[n.showOn];e.isRunning()||e.start(h)}},hide:function(t,e){var e=t.retrieve("opts")[e],i=t.retrieve("tip")[e.showOn],n=t.retrieve("fxs")[e.showOn];this.hideOthers(t),n.isRunning()&&"mouseenter"!==e.showOn&&"mouseleave"!==e.hideOn||(n.hideMe=!0,i.hide(),t.store("active",!1))},hideOthers:function(e){this.element&&this.elements.each(function(t){t!==e&&(t=t.retrieve("tip"),$H(t).each(function(t){t.hide()}))})},hideAll:function(){this.elements.each(function(t){t=t.retrieve("tip");$H(t).each(function(t){t.hide()})})}});
//# sourceMappingURL=tips.js.map