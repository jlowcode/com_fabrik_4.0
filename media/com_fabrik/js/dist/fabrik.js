/*! Fabrik */
define(["jquery","fab/loader","fab/requestqueue"],function(l,e,t){var o=l(document),c=(document.addEvent("click:relay(.popover button.close)",function(e,t){var t="#"+t.get("data-popover"),o=document.getElement(t);l(t).popover("hide"),"null"!==typeOf(o)&&"input"===o.get("tag")&&(o.checked=!1)}),{events:{}});return c.bootstrapVersion=function(e){for(var t=[e||"modal","tooltip"],o=t.length,i=0;i<o;++i){var n=l.fn[t[i]];if(n){if(n.VERSION)return n.VERSION.match(/(\d+)\./)[0].toInt();if(n.Constructor&&n.Constructor.VERSION)return n.Constructor.VERSION.match(/(\d+)\./)[0].toInt()}}return 2},c.Windows={},c.loader=new e,c.blocks={},c.periodicals={},c.addBlock=function(e,t){c.blocks[e]=t,c.fireEvent("fabrik.block.added",[t,e])},c.getBlock=function(e,t,o){return(o=o||!1)&&(c.periodicals[e]=c._getBlock.periodical(500,this,[e,t,o])),c._getBlock(e,t,o)},c._getBlock=function(e,t,o){var i;if(t=t||!1,void 0!==c.blocks[e])i=e;else{if(t)return!1;var t=Object.keys(c.blocks),n=t.searchFor(e);if(-1===n)return!1;i=t[n]}return o&&(clearInterval(c.periodicals[e]),o(c.blocks[i])),c.blocks[i]},o.on("click",".fabrik_delete a, .fabrik_action a.delete, .btn.delete",function(e){e.rightClick||c.watchDelete(e,this)}),o.on("click",".fabrik_edit a, a.fabrik_edit",function(e){e.rightClick||c.watchEdit(e,this)}),o.on("click",".fabrik_view a, a.fabrik_view",function(e){e.rightClick||c.watchView(e,this)}),document.addEvent("click:relay(*[data-fabrik-view])",function(e,t){var o;e.rightClick||(e.preventDefault(),o=(o=(e="a"===e.target.get("tag")?e.target:"null"!==typeOf(e.target.getElement("a"))?e.target.getElement("a"):e.target.getParent("a")).get("href"))+(o.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1")+"&format=partial",$H(c.Windows).each(function(e,t){e.close()}),e={id:"view."+o,title:e.get("title")||Joomla.JText._("COM_FABRIK_VIEW"),loadMethod:"xhr",contentURL:o},c.getWindow(e))}),c.removeEvent=function(e,t){c.events[e]&&-1!==(t=c.events[e].indexOf(t))&&delete c.events[e][t]},c.addEvent=c.on=function(e,t){c.events[e]||(c.events[e]=[]),c.events[e].contains(t)||c.events[e].push(t)},c.addEvents=function(e){for(var t in e)e.hasOwnProperty(t)&&c.addEvent(t,e[t]);return this},c.fireEvent=c.trigger=function(e,t,o){var i=c.events;return this.eventResults=[],i&&i[e]&&(t=Array.mfrom(t),i[e].each(function(e){o?this.eventResults.push(e.delay(o,this,t)):this.eventResults.push(e.apply(this,t))},this)),this},c.requestQueue=new t,c.cbQueue={google:[]},c.loadGoogleMap=function(e,t,o){var i=("https:"===document.location.protocol?"https:":"http:")+"//maps.googleapis.com/maps/api/js?libraries=places,visualization&callback=Fabrik.mapCb";!1!==e&&(i+="&key="+e),""!==o&&(i+="&language="+o),0===Array.mfrom(document.scripts).filter(function(e){return e.src===i}).length?((e=document.createElement("script")).type="text/javascript",e.src=i,document.body.appendChild(e),c.cbQueue.google.push(t)):c.googleMap?window[t]():c.cbQueue.google.push(t)},c.mapCb=function(){var e,t;for(c.googleMap=!0,t=0;t<c.cbQueue.google.length;t++)e=c.cbQueue.google[t],"function"===typeOf(e)?e():window[e]();c.cbQueue.google=[]},c.watchDelete=function(e,t){var o,i,n=e.target.getParent(".fabrik_row");(n=n||c.activeRow)?(i=n.getElement("input[type=checkbox][name*=id]"),"null"!==typeOf(i)&&(i.checked=!0),i=(i=n.id.split("_")).splice(0,i.length-2).join("_"),o=c.blocks[i]):(i=e.target.getParent(".fabrikList"),"null"!==typeOf(i)?(i=i.id,o=c.blocks[i]):(i=(n=t.getParent(".floating-tip-wrapper"))?n.retrieve("list").id:t.get("data-listRef"),void 0===(o=c.blocks[i])||"floating"!==o.options.actionMethod||this.bootstrapped||o.form.getElements("input[type=checkbox][name*=id], input[type=checkbox][name=checkAll]").each(function(e){e.checked=!0}))),o.submit("list.delete")||e.preventDefault()},c.watchEdit=function(e,t){c.openSingleView("form",e,t)},c.watchView=function(e,t){c.openSingleView("details",e,t)},c.openSingleView=function(t,e,o){var i,n,a=l(o).data("list"),r=c.blocks[a];if(1===l(o).data("isajax")){if(r){if(!r.options.ajax_links)return;if(!(n=r.getActiveRow(e))||0===n.length)return;r.setActive(n),i=n.prop("id").split("_").pop()}else i=l(o).data("rowid");e.preventDefault(),e=(n="A"===l(e.target).prop("tagName")?l(e.target):0<l(e.target).find("a").length?l(e.target).find("a"):l(e.target).closest("a")).prop("href"),1!==l(o).data("iscustom")&&(e=e+(e.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1")+"&format=partial"),o=n.prop("title"),void 0===(n=n.data("loadmethod"))&&(n="xhr"),l.each(c.Windows,function(e,t){t.close()}),o={modalId:"ajax_links",id:a+"."+i,title:o,loadMethod:n,contentURL:e,onClose:function(){var e=t+"_"+r.options.formid+"_"+i;try{c.blocks[e].destroyElements(),c.blocks[e].formElements=null,c.blocks[e]=null,delete c.blocks[e],c.fireEvent("details"===t?"fabrik.list.row.view.close":"fabrik.list.row.edit.close",[a,i,e])}catch(e){console.log(e)}}},r&&(""!==r.options.popup_width&&(o.width=r.options.popup_width),""!==r.options.popup_height&&(o.height=r.options.popup_height),o.id="details"===t?"view."+o.id:"add."+o.id,null!==r.options.popup_offset_x&&(o.offset_x=r.options.popup_offset_x),null!==r.options.popup_offset_y)&&(o.offset_y=r.options.popup_offset_y),c.getWindow(o)}},c.timePickerClose=function(e,t){var o,i;e&&0<(i=l(e).closest("form")).length&&(i=c.getBlock(i[0].id))&&0<(o=l(e).closest(".fabrikSubElementContainer")).length&&(i=i.formElements.get(o[0].id))&&i.hideTime(e,t)},c.Array={chunk:function(e,t){for(var o=[],i=0,n=e.length;i<n;i+=t)o.push(e.slice(i,i+t));return o}},window.fireEvent("fabrik.loaded"),window.Fabrik=c});
//# sourceMappingURL=fabrik.js.map